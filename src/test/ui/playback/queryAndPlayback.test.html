<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="utf-8">
    <title>Query And Playback Test</title>

    <link rel="stylesheet" href="../../../main/ui/vendor/bower/leaflet-dist/leaflet.css">
    <link rel="stylesheet" href="../../../../target/stealth/css/style.css">

    <script type="text/javascript" src="../../../main/ui/vendor/bower/leaflet-dist/leaflet.js"></script>
    <script type="text/javascript" src="../../../main/ui/vendor/bower/angular/angular.js"></script>
    <script type="text/javascript" src="../../../main/ui/vendor/bower/lodash/dist/lodash.js"></script>
    <script type="text/javascript" src="../../../main/ui/vendor/openlayers/OpenLayers.js"></script>
    <script type="text/javascript" src="../../../main/ui/vendor/bower/jquery/dist/jquery.js"></script>
    <script type="text/javascript" src="../../../main/ui/vendor/bower/momentjs/moment.js"></script>
    <script type="text/javascript" src="../../../main/ui/vendor/bower/angular-ui-bootstrap-bower/ui-bootstrap-tpls.js"></script>
    <script type="text/javascript" src="../../../main/ui/vendor/bower/angular-bootstrap-colorpicker/js/bootstrap-colorpicker-module.js"></script>
    <script type="text/javascript" src="../../../main/ui/vendor/bower/html5slider.polyfill/html5slider.js"></script>
    <script type="text/javascript" src="../../../main/ui/vendor/bower/bowser/bowser.js"></script>

    <script type="text/javascript" src="../../../../target/stealth/templates-app.js"></script>
    <script type="text/javascript" src="../../../main/ui/src/app/ows/OpenLayers/Format/WFSCapabilities/v1_1_0_custom.js"></script>
    <script type="text/javascript" src="../../../main/ui/src/app/ows/ows.js"></script>
    <script type="text/javascript" src="../../../main/ui/src/app/common/layermanager/leaflet/layerManager.js"></script>
    <script type="text/javascript" src="../../../main/ui/src/app/common/control/playbackControl.js"></script>
    <script type="text/javascript" src="../../../main/ui/src/app/common/control/leaflet/layersLegendControl.js"></script>
    <script type="text/javascript" src="../../../main/ui/src/app/common/store/binaryDataStore.js"></script>
    <script type="text/javascript" src="../../../main/ui/src/app/common/filters.js"></script>
    <script type="text/javascript" src="../../../main/ui/src/app/common/utils.js"></script>
    <script type="text/javascript" src="../../../main/ui/src/app/common/forms/managers.js"></script>
    <script type="text/javascript" src="../../../main/ui/src/app/common/map/leaflet/map.js"></script>
    <script type="text/javascript" src="../../../main/ui/src/app/common/map/leaflet/canvas.js"></script>
    <script type="text/javascript" src="../../../main/ui/src/app/common/map/leaflet/L.CanvasOverlay.js"></script>
    <script type="text/javascript" src="../../../main/ui/src/app/common/map/leaflet/countries.js"></script>
</head>
<body>
    <div ng-app="queryAndPlaybackTest">
        <tracker-controls-test>
            <leaflet-playback-map id="testMap"></leaflet-playback-map>
        </tracker-controls-test>
    </div>

        <script type="text/javascript">

            angular.module('queryAndPlaybackTest', [
                'stealth.common.forms.managers',
                'stealth.common.map.leaflet.map',
                'templates-app'
            ])

                .config(['$provide', function ($provide) {
                    var proxyUrl = "http://localhost:9900/geoserver";
                    var wmsUrl = proxyUrl + "/wms";
                    var config = {
                        geoserver: {
                            defaultUrl: proxyUrl,
                            omitProxy: true
                        },
                        map: {
                            url: wmsUrl,
                            baseLayers: [
                                {
                                    name: "OSM Toner",
                                    url: wmsUrl,
                                    getMapParams: {
                                        layers: "mapproxy:globe.osm.toner",
                                        format: "image/png",
                                    }
                                },
                                {
                                    name: "OSM Default",
                                    url: wmsUrl,
                                    getMapParams: {
                                        layers: "mapproxy:globe.osm.default",
                                        format: "image/png",
                                    }
                                }
                            ],
                            format: "image/png",
                            lat: "33",
                            lon: "-81",
                            zoom: "8",
                            minZoom: "1",
                            maxZoom: "10"
                        },
                        airTracker: {
                            data: {
                                layer: "whiptail:fr",
                                threadingKey: "hexid"
                            }
                        },
                        trackStyles: [
                            {
                                contributor: "ADSB",
                                labelName: "Radar 24",
                                color: "#ff7800",
                                weight: 8,
                                opacity: 1.0,
                                numSegments: 8
                            },
                            {
                                contributor: "Other",
                                labelName: "Other",
                                color: "#000000",
                                weight: 3,
                                opacity: 1.0,
                                numSegments: 5
                            }
                        ]
                    };
                    $provide.constant('CONFIG', config);
                }])

                .run(['QueryFormManager', function(QueryFormManager) {
                    var query = QueryFormManager.getQueryData('playback');
                    query.params.startDate = new Date(2014, 2, 1, 0, 0);
                    query.params.startTime = _.cloneDeep(query.params.startDate);
                    query.params.endDate = new Date(2014, 2, 1, 1, 0);
                    query.params.endTime = _.cloneDeep(query.params.endDate);
                }])

                .directive('trackerControlsTest', function () {
                        return {
                            restrict: 'E',
                            replace: true,
                            transclude: true,
                            template: '<div ng-transclude></div>',
                            link: function (scope, element, attrs) {
                                console.debug('(queryAndPlaybackTest) Starting Test');
                            }//END of link function
                        };
                    }
                );

        </script>
    </div>

</body>
</html>
