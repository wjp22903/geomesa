<ng-form name="wizardForm">
    <table class="df-wizard-table" ng-class="{'ng-hide': boundWiz.drawing}">
        <tr>
            <td>
                <select class="form-control input-sm"
                    ng-model="query.classifier"
                    ng-options="classifier.name for classifier in classifiers | orderBy: 'name'"
                    required>
                    <option value="" selected disabled>Select a Classifier</option>
                </select>
            </td>
        </tr>
        <tr>
            <td ng-class="{'ng-hide': query.hasSingleLabel()}">
                <select class="form-control input-sm"
                    ng-model="query.classifierLabel"
                    ng-options="label for label in query.classifier.labels"
                    required>
                    <option value="" selected disabled>Select a Label</option>
                </select>
            </td>
        </tr>
    </table>
    <table class="df-wizard-table" ng-class="{'ng-hide': boundWiz.drawing || query.isNonImageSpace()}">
        <tr ng-click="query.geomSource = constant.byid">
            <td>
                <i class="fa fa-fw" ng-class="query.isImageIdSource() ? 'fa-dot-circle-o' : 'fa-circle-o'"
                   ng-click="query.geomSource = constant.byid">
                </i>
                <input type="text"
                   placeholder="Enter Image ID"
                   ng-model="query.imageId"
                   ng-required="query.isImageIdSource()"
                   class="form-control input-sm df-wizard-text-input df-wizard-selector" />
            </td>
        </tr>
    </table>
    <table class="df-wizard-table">
        <tr ng-click="query.geomSource = constant.geom">
            <td ng-class="{'ng-hide': boundWiz.drawing}">
                <i class="fa fa-fw" ng-class="query.isGeomSource() ? 'fa-dot-circle-o' : 'fa-circle-o'"
                   ng-click="query.geomSource = constant.geom">
                </i>
                <label ng-class="{'ng-hide': query.isGeomSource()}" class="df-wizard-bounds-title">
                    Bounding Box
                </label>
            </td>
            <td>
                <st-widget-compiler widget-def="drawBoundsWidgetDef">
                </st-widget-compiler>
            </td>
        </tr>
        <tr ng-class="{'ng-hide': !query.isGeomSource()}">
            <td />
            <td ng-class="{'ng-hide': boundWiz.drawing}" colspan="2">
                <!-- Only an input when not using an image id. Otherwise the time is the time of the image -->
                <table class="df-wizard-table">
                    <tr><label>Enter time range:</label></tr>
                    <tr>
                        <td><label>Start: </label></td>
                        <td><input type="text" ng-model="query.timeData.startDtg" ui-jq="datetimepicker"
                            ng-change="query.checkAndSetTimeRange(query.timeData.startDtg, query.timeData.endDtg)"
                            ng-disabled="query.isImageIdSource()"
                            ng-required="!query.isImageIdSource()"
                            ui-options="{todayButton: false, yearStart: 1990, yearEnd: 2030, step: 15, format: 'Y-m-d H:i'}"
                            st-utc-moment-format="YYYY-MM-DD HH:mm" class="df-datetimepicker"> Z
                        </td>
                    </tr>
                    <tr>
                        <td><label>End: </label></td>
                        <td><input type="text" ng-model="query.timeData.endDtg" ui-jq="datetimepicker"
                            ng-change="query.checkAndSetTimeRange(query.timeData.startDtg, query.timeData.endDtg)"
                            ng-disabled="query.isImageIdSource()"
                            ng-required="!query.isImageIdSource()"
                            ui-options="{todayButton: false, yearStart: 1990, yearEnd: 2030, step: 15, format: 'Y-m-d H:i'}"
                            st-utc-moment-format="YYYY-MM-DD HH:mm" class="df-datetimepicker"> Z
                        </td>
                    </tr>
                </table>
                <!-- this input is a bit finicky. any value in query.timeData.valid will validate,
                     even if the value is a boolean false. make sure _not_ to set a valid flag until
                     the query.timeData is actually valid. do _not_ set valid to false. -->
                <input type="hidden" ng-model="query.timeData.valid" ng-required="!query.isImageIdSource()">
                <div class="alert alert-danger" ng-class="{'ng-hide': !query.timeData.errorMsg}">
                    <span class="fa fa-lg fa-fw fa-exclamation-triangle"></span>
                    <span>{{query.timeData.errorMsg}}</span>
                </div>
            </td>
        </tr>
    </table>
    <table class="df-wizard-table" ng-class="{'ng-hide': boundWiz.drawing || query.isNonImageSpace()}">
        <tr>
            <!-- Only visible for imagery classifiers. Defaults to false -->
            <td>
                <label><input type="checkbox" ng-model="query.slidingWindow" /> Use sliding window</label>
            </td>
        </tr>
    </table>
    <input type="text" ng-model="query.geomSource" class="df-input-hidden" required />
</ng-form>
