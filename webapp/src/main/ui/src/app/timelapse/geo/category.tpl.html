<div style="max-height:300px;overflow:auto;">
    <!--<div ng-hide="workspaces.live | isEmpty" class="categoryGrouping">-->
    <div class="categoryGrouping">
        <div class="categoryCell">
            <span class="btn fa-stack toggleSlide"
                  ng-click="toggleSlideLive(timelapse.isLiveOn)">
                <i class="fa fa-fw fa-toggle-on fa-stack-2x text-primary"
                   ng-if="timelapse.isLiveOn"
                   style="margin-top:-7px">
                </i>
                <i class="fa fa-fw fa-toggle-off fa-stack-2x text-danger"
                   ng-if="!timelapse.isLiveOn"
                   style="margin-top:-7px">
                </i>
            </span>
        </div>
        <div class="categoryCell"><b>Live</b></div>
        <div class="categoryCell">
            <span class="btn btn-default fa-stack toggleButton"
                  ng-click="launchLiveQueryWizard()"
                  tooltip-html-unsafe="<span style='white-space:nowrap'>Add layer</span>"
                  tooltip-placement="right" tooltip-animation="false" tooltip-popup-delay="500"
                  tooltip-trigger="mouseenter"
                  style="line-height:6px">
                <i class="fa fa-fw fa-plus fa-stack-1x text-primary"></i>
            </span>
        </div>
        <div class="categoryCell" style="width:100%;text-align:right;">
            <span class="btn btn-default fa-stack toggleButton"
                  ng-click="refreshNow()"
                  tooltip-html-unsafe="<span style='white-space:nowrap'>Refresh now</span>"
                  tooltip-placement="right" tooltip-animation="false" tooltip-popup-delay="500"
                  tooltip-trigger="mouseenter"
                  style="line-height:6px">
                <i class="fa fa-fw fa-repeat fa-stack-1x text-primary"></i>
            </span>
        </div>
        <div class="categoryCell">
            <span style="margin-left:2px">
                Refresh:
                <select ng-model="liveRefresh.value"
                        ng-options="val for val in liveRefresh.options"
                        ng-change="refreshValChanged(liveRefresh.value)">
                </select>
                s
            </span>
        </div>
        <div ng-repeat="(workspace, layers) in workspaces.live"
             class="categoryGrouping categoryIndent"
             ng-show="timelapse.isLiveOn">
            <div ng-repeat="layer in layers">
                <div class="categoryCell">
                    <span ng-if="!layer.viewState.isOnMap && !layer.viewState.isLoading"
                          class="btn btn-default fa-stack toggleButton"
                          ng-click="toggleLiveLayer(layer)"
                          tooltip-html-unsafe="<span style='white-space:nowrap'>Add to map</span>"
                          tooltip-placement="right" tooltip-animation="false" tooltip-popup-delay="500"
                          tooltip-trigger="mouseenter">
                    </span>
                    <span ng-if="layer.viewState.isOnMap && layer.viewState.isLoading"
                          style="padding-left:6px;padding-right:6px"
                          tooltip-html-unsafe="<span style='white-space:nowrap'>{{layer.viewState.numLoaded}}/{{layer.viewState.numTiles}} loaded</span>"
                          tooltip-placement="right" tooltip-animation="false" tooltip-popup-delay="500"
                          tooltip-trigger="mouseenter">
                        <i class="fa fa-circle-o-notch fa-spin"></i>
                    </span>
                    <span ng-if="layer.viewState.isOnMap && !layer.viewState.isLoading"
                          class="btn btn-default fa-stack toggleButton"
                          ng-click="toggleLiveLayer(layer)"
                          tooltip-html-unsafe="<span style='white-space:nowrap'>Remove from map</span>"
                          tooltip-placement="right" tooltip-animation="false" tooltip-popup-delay="500"
                          tooltip-trigger="mouseenter">
                        <i class="fa fa-fw fa-check fa-stack-1x"></i>
                    </span>
                </div>
                <div class="categoryCell">
                    <span ng-if="layer.viewState.isOnMap"
                          class="btn btn-default fa-stack toggleButton"
                          ng-click="toggleLiveVisibility(layer)"
                          tooltip-html-unsafe="<span style='white-space:nowrap'>Toggle visibility</span>"
                          tooltip-placement="right" tooltip-animation="false" tooltip-popup-delay="500"
                          tooltip-trigger="mouseenter">
                        <i class="fa fa-fw fa-eye fa-stack-1x text-danger"
                           ng-if="!layer.viewState.toggledOn"></i>
                        <i class="fa fa-fw fa-eye fa-stack-1x text-success"
                           ng-if="layer.viewState.toggledOn"></i>
                    </span>
                </div>
                <div class="categoryCell">
                    {{::layer.Title | characters:35:true}}
                </div>
            </div>
        </div>
    </div>
    <div class="categoryGrouping">
        <div class="categoryCell">
            <span class="btn fa-stack toggleSlide"
                  ng-click="toggleSlideHistorical(timelapse.isHistoricalOn)">
                <i class="fa fa-fw fa-toggle-on fa-stack-2x text-primary"
                   ng-if="timelapse.isHistoricalOn"
                   style="margin-top:-7px">
                </i>
                <i class="fa fa-fw fa-toggle-off fa-stack-2x text-danger"
                   ng-if="!timelapse.isHistoricalOn"
                   style="margin-top:-7px">
                </i>
            </span>
        </div>
        <div class="categoryCell"><b>Historical</b></div>
        <div class="categoryCell">
            <span class="btn btn-default fa-stack toggleButton"
                  ng-click="launchHistoricalQueryWizard()"
                  tooltip-html-unsafe="<span style='white-space:nowrap'>Add layer</span>"
                  tooltip-placement="right" tooltip-animation="false" tooltip-popup-delay="500"
                  tooltip-trigger="mouseenter"
                  style="line-height:6px;">
                <i class="fa fa-fw fa-plus fa-stack-1x text-primary"></i>
            </span>
        </div>
        <div class="categoryCell">
            <span class="btn btn-default fa-stack toggleButton"
                  ng-click="uploadFile()"
                  tooltip-html-unsafe="<span style='white-space:nowrap'>Load file</span>"
                  tooltip-placement="right" tooltip-animation="false" tooltip-popup-delay="500"
                  tooltip-trigger="mouseenter"
                  style="line-height:6px;">
                <i class="fa fa-fw fa-folder-open fa-stack-1x text-primary" style="padding-left:2px"></i>
            </span>
        </div>
        <div style="height:0px;width:0px;overflow:hidden">
            <input id="upfile" type="file"
                   onchange="angular.element(this).scope().fileSelected(this)">
        </div>
        <div ng-repeat="store in historicalLayer.getStores()"
             class="categoryGrouping categoryIndent"
             ng-show="timelapse.isHistoricalOn">
            <div id="col0" class="categoryCell">
                <div ng-if="store.getViewState().isDataPending() && !store.getViewState().isError">
                    <i class="fa fa-circle-o-notch fa-spin"></i>
                </div>
                <div ng-if="store.getViewState().isError" class="errorIconWrapper">
                    <i class="fa fa-warning text-danger"
                       tooltip-html-unsafe="<span style='white-space:nowrap;background-color:#a94442;color:white'>{{store.getViewState().errorMsg}}</span>"
                       tooltip-placement="right" tooltip-animation="false" tooltip-popup-delay="500"
                       tooltip-trigger="mouseenter">
                    </i>
                </div>
                <span ng-if="store.getViewState().isDataReady() && !store.getViewState().colorById"
                      class="btn btn-default toggleButton"
                      ng-click="store.toggleColorById()"
                      ng-style="{'background-color': store.getFillColorHexString()}"
                      tooltip-html-unsafe="<span style='white-space:nowrap'>Toggle color by</span>"
                      tooltip-placement="right" tooltip-animation="false" tooltip-popup-delay="500"
                      tooltip-trigger="mouseenter">
                </span>
                <span ng-if="store.getViewState().isDataReady() && store.getViewState().colorById"
                      ng-click="store.toggleColorById()"
                      class="btn btn-default toggleButton rainbow"
                      tooltip-html-unsafe="<span style='white-space:nowrap'>Toggle color by</span>"
                      tooltip-placement="right" tooltip-animation="false" tooltip-popup-delay="500"
                      tooltip-trigger="mouseenter">
                </span>
            </div>
            <div id="col1" class="categoryCell">
                <span ng-if="store.getViewState().isDataReady()"
                      class="btn btn-default fa-stack toggleButton"
                      ng-click="store.toggleVisibility()"
                      tooltip-html-unsafe="<span style='white-space:nowrap'>Toggle visibility</span>"
                      tooltip-placement="right" tooltip-animation="false" tooltip-popup-delay="500"
                      tooltip-trigger="mouseenter">
                    <i class="fa fa-fw fa-eye fa-stack-1x text-danger"
                       ng-if="!store.getViewState().toggledOn"></i>
                    <i class="fa fa-fw fa-eye fa-stack-1x text-success"
                       ng-if="store.getViewState().toggledOn"></i>
                </span>
            </div>
            <div id="col2" class="categoryCell">
                {{store.getName()}}
            </div>
            <div id="col3" class="categoryCell" style="width:100%;text-align:right">
                <span class="btn btn-default catGroupButton"
                      ng-if="store.getViewState().isDataReady() || store.getViewState().isError"
                      ng-click="removeHistorical(store)">
                    <i class="fa fa-fw fa-remove text-danger"></i>
                </span>
            </div>
        </div>
    </div>
    <div ng-hide="workspaces.summary | lodash:'isEmpty'" class="categoryGrouping">
        <input type="checkbox" ng-model="timelapse.summaryOn"
               bs-switch switch-size="micro" switch-label-width="0">
        <b>Summary</b>
        <span class="btn btn-default btn-xs catGroupButton"
              ng-click="launchSummaryQueryWizard()">
            <i class="fa fa-fw fa-plus text-primary"></i>
        </span>
    </div>
</div>
